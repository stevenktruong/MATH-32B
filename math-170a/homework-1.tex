\documentclass{article}
\usepackage{amsmath, amssymb, mathtools, tikz, enumitem, fancyhdr, mleftright, wrapfig, scrextend}
\usetikzlibrary{calc}
\usepackage[margin = 1in]{geometry}

\def\class{MATH 170A}
\def\discussion{3A}
\def\header{Homework 1}
\def\first{Steven}
\def\last{Truong}

\fancypagestyle{first}
{
	\fancyhf{}
	\setlength{\headsep}{\baselineskip}
	\lhead{\class{} - Section \discussion}
	\chead{\header}
	\rhead{\last, \first}
	\cfoot{\thepage}
}

\thispagestyle{first}

%%%%%%%%%%%%Commands%%%%%%%%%%%%
\newcommand{\diff}[1]{\mathrm{d}#1}    % Upright differential
\newcommand{\qed}{\hfill$\blacksquare$}
\DeclarePairedDelimiter{\paren}{(}{)}
\DeclarePairedDelimiter{\brac}{[}{]}
\DeclarePairedDelimiter{\set}{\{}{\}}
\DeclarePairedDelimiter{\norm}{|}{|}
\newcommand{\zerospace}
{
	\setlength{\abovedisplayskip}{0pt}
	\setlength{\belowdisplayskip}{0pt}
	\setlength{\abovedisplayshortskip}{0pt}
	\setlength{\belowdisplayshortskip}{0pt}
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%Environments%%%%%%%%%%
\newenvironment{problem}[1]    % Problem environment
{
	\begin{enumerate}[leftmargin = 0in]
		\item[\bfseries{#1}]
}
{	\end{enumerate}
}
\newenvironment{multipart}
{
	\begin{enumerate}[leftmargin = *, align = left, label = {\alph*.}, topsep = 0pt]
}	
{
	\end{enumerate}
}
\newenvironment{proofcase}[1]
{
	\par
	#1
	\begin{addmargin}[1em]{0em}
}
{	
	\end{addmargin}
}
%%%%
\newenvironment{solution}    % Solution environment
{
	\begin{enumerate}[leftmargin = 0in]
		\item[\bfseries{Solution}]
}
{
	\end{enumerate}
}
%%%%
\newenvironment{nospaceflalign*}    % No extra vertical space before flalign* environment
{
	\setlength{\abovedisplayskip}{-\baselineskip}
	\csname flalign*\endcsname
}
{
	\csname endflalign*\endcsname
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%Homework%%%%%%%%%%%%%
\begin{document}

	\begin{problem}{4}
		If a day is sunny the probability that the next day will be rainy is $\frac{1}{2}$. If exactly $k$ consecutive days have been raining, the probability that the following day will be sunny is $\frac{1}{k + 1}$. If today is sunny, what is the probability that the next $n$ days will all be rainy?
	\end{problem}
	
	\begin{solution}
		If today was sunny, then the probability the 1st day after today is rainy is $\frac{1}{2}$. Then the probability the 2nd day after today is rainy will be $1 - \frac{1}{1 + 1} = \frac{1}{2}$. The 3rd will be $1 - \frac{1}{2 + 1} = \frac{2}{3}$, and so on. So, the probability that the next $n$ days will be rainy is
		\begin{align*}
			&\paren[\bigg]{\frac{1}{2}} \paren[\bigg]{\frac{1}{2}} \paren[\bigg]{\frac{2}{3}} \paren[\bigg]{\frac{3}{4}} \cdots \paren[\bigg]{\frac{n - 2}{n - 1}}\paren[\bigg]{\frac{n - 1}{n}} \\
			={}& \frac{1}{2n}
		\end{align*}
	\end{solution}
	
\hrule %%%%%%%%%%%%%%%%%%%%%%%%%

	\begin{problem}{6}
		You are running a day care center and today you are looking after $n$ babies. At the end of the day, $n$ parents arrive to collect their respective children. You are lazy and terrible at running a day care center so you give every parent a random baby.
		\begin{multipart}
			\item What is the probability that no parent ends up with the correct baby?
			\item What is the probability that exactly $k$ parents end up with the correct baby?
			\item What do these probabilities tend to as $n$ becomes very large?
		\end{multipart}

	\end{problem}

	\begin{solution}
		\begin{multipart}
			\item Each baby is distinguishable, so there are a total of $n!$ ways to return each baby to a parent. It will be easier to count the number of ways that at least 1 baby is returned to the correct parent first.
	
				Let $B_i$ be the event that the $i$-th baby is returned to the correct parents. Then the event $A$ where at least 1 baby is returned is \[ A = B_1 \cup B_2 \cup \cdots \cup B_n. \] To return baby $i$ correctly, there is 1 choice for baby $i$. Then we need to arrange the last $n - i$ babies in any way, so we will have $\paren{n - i}!$ ways to return baby $i$.
				
				Then applying the inclusion-exclusion principle, we get
				\begin{align*}
					\norm{A} &= \norm{B_1 \cup B_2 \cup B_3 \cup B_4 \cup \cdots \cup B_n} \\
					&= \sum_{i = 1}^{n} \norm{B_i} - \sum_{\mathclap{1 \leq i < j \leq n}} \norm{B_i \cap B_j} + \sum_{\mathclap{1 \leq i < j < k \leq n}} \norm{B_i \cap B_j \cap B_k} - \cdots + \paren{-1}^{n-1} \norm*{\bigcap_{i = 1}^n B_i}
				\end{align*}
				The first sum is equal to the number of ways to return 1 specific baby correctly. The second sum is equal to the number of ways to return 2 specific babies correctly, and so on. This is because for the $m$-th sum, we return $m$ babies correctly, and return the remaining $n - m$ babies any way we like. Each sum will have $\binom{n}{m}$ terms because we need to pick $m$ sets from $n$ total to union. Thus, the sum is equal to
				\begin{align*}
					&\binom{n}{1}\paren{n - 1}! - \binom{n}{2}\paren{n - 2}! + \binom{n}{3}\paren{n - 3}! + \cdots + \paren{-1}^{n-1} \binom{n}{n} \paren{n - n}! \\
					={}& \frac{n!}{1!} - \frac{n!}{2!} + \frac{n!}{3!} - \cdots + \paren{-1}^{n-1}
				\end{align*}
				Since each outcome is equally likely, the probability will be
				\begin{align*}
					&\frac{1}{n!} \paren*{\frac{n!}{1!} - \frac{n!}{2!} + \frac{n!}{3!} - \cdots + \paren{-1}^{n-1}} \\
					&= \frac{1}{1!} - \frac{1}{2!} + \frac{1}{3!} - \cdots + \frac{\paren{-1}^{n-1}}{n!}
				\end{align*}
			\item The problem is similar to the above, but first, we return $k$ babies correctly. There will be $\binom{n}{k}$ ways to do so, and then we have to make sure that the remaining $n - k$ babies are returned to the wrong parent. Thus, the number of ways for this to happen is
				\begin{align*}
					&\binom{n}{k} \paren*{\frac{\paren{n - k}!}{1!} - \frac{\paren{n - k}!}{2!} + \frac{\paren{n - k}!}{3!} - \cdots + \paren{-1}^{n-k-1}} \\
					={}& \frac{n!}{k!\paren{n - k}!} \paren*{\frac{\paren{n - k}!}{1!} - \frac{\paren{n - k}!}{2!} + \frac{\paren{n - k}!}{3!} - \cdots + \paren{-1}^{n-k-1}} \\
					={}& \frac{n!}{k!} \paren*{\frac{1}{1!} - \frac{1}{2!} + \frac{1}{3!} - \cdots + \frac{\paren{-1}^{n-k-1}}{\paren{n - k}!}}
				\end{align*}
				Each outcome is equally likely, and there are $n!$ ways to return the babies, so the probability will be
				\begin{align*}
					\frac{1}{k!} \paren*{\frac{1}{1!} - \frac{1}{2!} + \frac{1}{3!} - \cdots + \frac{\paren{-1}^{n-k-1}}{\paren{n - k}!}}
				\end{align*}
			\item
			\begin{nospaceflalign*}
				&\lim_{n \to \infty} \paren*{\frac{1}{1!} - \frac{1}{2!} + \frac{1}{3!} - \cdots + \frac{\paren{-1}^{n-1}}{n!}} = e^{-1} & \\
				&\lim_{n \to \infty} \brac*{\frac{1}{k!} \paren*{\frac{1}{1!} - \frac{1}{2!} + \frac{1}{3!} - \cdots + \frac{\paren{-1}^{n-k-1}}{\paren{n - k}!}}} = \frac{e^{-1}}{k!}
			\end{nospaceflalign*}
		\end{multipart}
	\end{solution}
	
\end{document}
